<!-- backend/templates/properties.html -->
<!doctype html>
<html lang="{{ session.get('lang', 'en') }}">
<head>
  <meta charset="utf-8" />
  <title>Properties ‚Äî {{ t.brand if t else "Ravuri Properties" }}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/static/style.css" />
  <link rel="stylesheet" href="/static/style-additions.css?v=20251019" />
  <style>
    /* small in-template tweaks (minimal, non-destructive) */
    .hero-title { display:flex; align-items:baseline; gap:6px; }
    .brand-red { color: var(--brand-red); font-weight:900; font-size:1.45rem; font-family: "Georgia", serif; line-height:1; }
    .brand-dark { color: #0b1720; font-weight:800; font-size:1.3rem; line-height:1; }
    .lang-links a { color:var(--muted); text-decoration:none; margin-left:8px; }
    .meta { margin-top:6px; }
  </style>
</head>
<body>
  <!-- HERO / BRAND -->
  <div class="site-hero" role="banner">
    <div class="hero-inner">
      <div class="hero-title">
        <!-- Ravuri (red) / Properties (black) -->
        <div class="brand">
          <span class="brand-red">Ravuri</span>
          <span class="brand-dark">Properties</span>
        </div>
      </div>

      <div style="display:flex;align-items:center;gap:12px;">
        <div class="lang-links" aria-label="Language switch">
          <a href="/lang/en">English</a> ‚Ä¢ <a href="/lang/th">‡πÑ‡∏ó‡∏¢</a>
        </div>

        {% if t.publishable_key %}
          <div class="stripe-badge" aria-hidden="false">Secure payments by Stripe</div>
        {% endif %}
      </div>
    </div>
  </div>

  <main class="wrap" role="main">
    <!-- intro + trust row -->
    <div class="intro" style="margin-bottom:8px">
      <h1 style="margin:0 0 8px">{{ "Our Properties" if session.get('lang','en') == 'en' else "‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤" }}</h1>
      <p style="margin:0 0 12px; color:var(--muted)">
        {% if session.get('lang','en') == 'en' %}
          Browse our curated villas and apartments. Click View for details or Book to open the booking panel.
        {% else %}
          ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏∏‡πà‡∏° View ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î Book ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏á
        {% endif %}
      </p>
    </div>

    <div class="trust-row" aria-hidden="false">
      <div class="trust-card">
        <div class="trust-title">üîí Secure payments</div>
        <div style="color:var(--muted)">Payments processed by Stripe. Card data never stored on this site.</div>
      </div>
      <div class="trust-card">
        <div class="trust-title">‚úÖ Instant confirmation</div>
        <div style="color:var(--muted)">Booking blocks dates immediately and you will receive an email confirmation.</div>
      </div>
      <div class="trust-card">
        <div class="trust-title">üìû Support</div>
        <div style="color:var(--muted)">Email: {{ t.support_email or 'support@ravuri.example' }} ‚Äî response within 24 hours.</div>
      </div>
    </div>

    <!-- GRID OF PROPERTIES -->
    <div class="grid" role="list">
      {% for slug, info in groups.items() %}
      <article class="card" role="listitem" aria-labelledby="title-{{ loop.index }}">
        <a href="/prop/{{ slug }}" style="text-decoration:none;color:inherit">
          <img src="{{ info.image_url }}" alt="{{ info.title }}">
        </a>

        <div class="pad">
          <div>
            <div id="title-{{ loop.index }}" class="title">{{ info.title }}</div>

            <!-- intentionally do NOT show raw unit IDs in public view:
                 only show the count (so internal ids are hidden) -->
            <div class="meta">
              {{ info.unit_ids|length }} {{ 'unit' if info.unit_ids|length == 1 else 'units' }}
              {% if info.price %}
                &nbsp;‚Ä¢&nbsp;
                <strong class="price">‡∏ø {{ '%.0f'|format(info.price) }}</strong>
                <span class="muted">/ night ({{ info.currency or 'THB' }})</span>
              {% else %}
                &nbsp;‚Ä¢&nbsp;<span class="muted">Price: not set</span>
              {% endif %}
            </div>

            {% if info.teaser %}
              <div class="teaser" style="margin-top:8px;color:#374151">{{ info.teaser }}</div>
            {% endif %}
          </div>

          <div class="card-actions">
            <a class="btn btn-outline" href="/prop/{{ slug }}">View</a>
            <a class="btn btn-primary" href="/prop/{{ slug }}#book">Book</a>
          </div>
        </div>
      </article>
      {% endfor %}
    </div>

    <div class="page-footer">
      <small class="muted">¬© {{ t.brand if t else "Ravuri Properties" }} ‚Äî Built with care</small>
    </div>
  </main>
</body>
</html>
